<!DOCTYPE html>
<html lang="en" data-bs-theme="dark">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>PokeLocke</title>

    <!-- ============================================= -->
    <!-- IMPORTS (Do not touch these)                  -->
    <!-- ============================================= -->
    <!-- 1. BOOTSTRAP: Makes styling easy -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- 2. ICONS: For the cool symbols -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <!-- 3. AOS: For the scrolling animations -->
    <link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet">
    <!-- 4. OUR CUSTOM CSS: The file where we write our own rules -->
    <link rel="stylesheet" href="styles.css">
    <script>
    (function() {
        // 1. Leer preferencia guardada
        const savedTheme = localStorage.getItem('theme');
        
        // 2. Determinar tema (Si no hay nada guardado, forzamos 'dark' por defecto)
        const themeToApply = savedTheme ? savedTheme : 'dark';
        
        // 3. Aplicar INMEDIATAMENTE al documento antes de que se renderice nada
        document.documentElement.setAttribute('data-bs-theme', themeToApply);
    })();
    </script>
</head>

<body>
    <!-- ============================================= -->
    <!-- NAVBAR                                        -->
    <!-- ============================================= -->
    <header class="app-header fixed-top">
        <div class="container-fluid d-flex justify-content-between align-items-center py-2 px-3">
            <a class="navbar-brand fw-bold" href="index.html">
                <i class="bi bi-controller text-primary"></i> Pok√©Locke
            </a>
        </div>
    </header>

    <nav class="app-dock">
        <div class="dock-container">
            
            <a href="index.html" class="dock-item" title="Inicio">
                <i class="bi bi-house-door-fill"></i>
            </a>

            <a href="create.html" class="dock-item" title="Crear Sala">
                <i class="bi bi-plus-circle-fill"></i>
            </a>

            <a href="join.html" class="dock-item" title="Unirse">
                <i class="bi bi-box-arrow-in-right"></i>
            </a>

            <a href="groups.html" class="dock-item" title="Mis Grupos">
                <i class="bi bi-grid-fill"></i>
            </a>

            <div class="dock-divider"></div>

            <button class="dock-item theme-toggle-btn" id="theme-toggle" title="Cambiar Tema">
                <i class="bi bi-sun-fill"></i>
            </button>
        </div>
    </nav>

    <!-- ============================================= -->
    <!-- STATS SECTION                                 -->  
    <!-- ============================================= -->
    <section id="stats" class="py-5 fade-up">
        <div class="container" data-aos="fade-up">
            <div class="text-center mb-5">
                <h2 class="fw-bold" id="view-party-name">Cargando Sala...</h2>
                <p class="text-body-secondary">Host: <span id="view-host-name">...</span></p>
                <div class="badge bg-primary fs-6 mb-3" id="view-player-count">Jugadores: 0/0</div>
            </div>
            <div class="row g-4 mb-5">
                <div class="col-md-6">
                    <div class="card h-100 p-4 shadow-sm border-danger" style="border-left-width: 5px;">
                        <h4 class="fw-bold mb-3"><i class="bi bi-exclamation-triangle-fill text-danger me-2"></i>Reglas</h4>
                        <p id="view-rules" style="white-space: pre-line;">Cargando reglas...</p>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card h-100 p-4 shadow-sm border-info" style="border-left-width: 5px;">
                        <h4 class="fw-bold mb-3"><i class="bi bi-info-circle-fill text-info me-2"></i>Descripci√≥n</h4>
                        <p id="view-desc" style="white-space: pre-line;">Sin descripci√≥n.</p>
                    </div>
                </div>
            </div>

            <h3 class="fw-bold mb-4 border-bottom pb-2">Entrenadores</h3>
            <div id="players-grid" class="row g-4">
                </div>
        </div>
    </section>
    <!-- ============================================= -->
    <!-- CAPTURE BUTTON & MODAL                        -->
    <!-- ============================================= -->
    <section>
        <div class="fixed-bottom container p-4 text-end" style="z-index: 1000; pointer-events: none;">
            <button class="btn btn-primary rounded-circle shadow-lg p-3" 
                style="width: 60px; height: 60px; pointer-events: auto;" 
                data-bs-toggle="modal" 
                data-bs-target="#captureModal">
            <i class="bi bi-plus-lg fs-4"></i>
            </button>
        </div>

        <div class="modal fade" id="captureModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header bg-primary text-white">
                        <h5 class="modal-title fw-bold"><i class="bi bi-pokeball me-2"></i>Nueva Captura</h5>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
                    </div>
                    <div class="modal-body">
                        <form id="form-captura">
                            <div class="mb-3">
                                <label for="poke-especie" class="form-label">Pok√©mon</label>
                                <input type="text" id="poke-especie" class="form-control" placeholder="Ej: Bulbasaur" required>
                                <div class="form-text">Escribe el nombre en ingl√©s para ver la imagen.</div>
                            </div>

                            <div class="mb-3">
                                <label for="poke-mote" class="form-label">Mote (Opcional)</label>
                                <input type="text" id="poke-mote" class="form-control" placeholder="Tu compa√±ero fiel">
                            </div>

                            <div class="row">
                                <div class="col-6 mb-3">
                                    <label for="poke-nivel" class="form-label">Nivel</label>
                                    <input type="number" id="poke-nivel" class="form-control" value="5" min="1" max="100">
                                </div>
                                <div class="col-6 mb-3">
                                    <label for="poke-estado" class="form-label">Estado</label>
                                    <select id="poke-estado" class="form-select">
                                        <option value="equipo" selected>Equipo</option>
                                        <option value="caja">PC (Caja)</option>
                                        <option value="cementerio">Muerto ‚ò†Ô∏è</option>
                                    </select>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                        <button type="button" class="btn btn-primary" onclick="guardarCaptura()">Guardar Pok√©mon</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- ============================================= -->
    <!-- DETAILS MODAL                                 -->  
    <!-- ============================================= -->
    <section>   
        <div class="modal fade" id="detailsModal" tabindex="-1" aria-hidden="true">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content border-0 shadow">
            
                <div class="modal-header bg-dark text-white" id="modal-details-header">
                    <h5 class="modal-title fw-bold" id="detail-title">Detalles</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>

                <div class="modal-body text-center">
                    <img id="detail-img" src="" class="mb-3" style="width: 120px; image-rendering: pixelated;">
                
                    <form id="form-editar">
                        <input type="hidden" id="edit-poke-id"> <div class="row g-2">
                            <div class="col-8">
                                <label class="form-label small text-muted">Mote</label>
                                <input type="text" id="edit-mote" class="form-control fw-bold text-center">
                            </div>
                            <div class="col-4">
                                <label class="form-label small text-muted">Nivel</label>
                                <input type="number" id="edit-nivel" class="form-control text-center">
                            </div>
                        </div>

                        <div class="mt-3">
                        <label class="form-label small text-muted">Estado Actual</label>
                                <select id="edit-estado" class="form-select text-center">
                                    <option value="equipo">üü¢ En el Equipo</option>
                                    <option value="caja">üì¶ En la Caja (PC)</option>
                                    <option value="cementerio">üíÄ Muerto (F)</option>
                                </select>
                             </div>
                    </form>
                </div>

                    <div class="modal-footer justify-content-between">
                        <button type="button" class="btn btn-outline-danger btn-sm" onclick="borrarPokemon()">
                            <i class="bi bi-trash"></i> Liberar
                        </button>
                        
                        <button type="button" class="btn btn-primary" onclick="guardarCambiosPokemon()">
                            <i class="bi bi-save"></i> Guardar Cambios
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- ============================================= -->
    <!-- FOOTER                                        -->
    <!-- ============================================= -->
    <footer class="py-4 text-center text-body-secondary border-top">
        <div class="container">
            <p class="mb-0">¬© 2025 ‚Äì Built with Bootstrap</p>
        </div>
    </footer>


    <!-- ============================================= -->
    <!-- SCRIPTS (Logic & Animation)                   -->
    <!-- ============================================= -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://unpkg.com/aos@2.3.1/dist/aos.js"></script>
    
    <!-- Initialize the Animation Library -->
    <script>
        AOS.init({ once: true, offset: 120 });
    </script>

    <!-- Load our custom logic -->
    <script src="script.js"></script>

  </body>
</html>